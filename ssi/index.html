<!DOCTYPE html>
<html>
<head>
<title>StudentStream Investigations</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<header>
  <b>StudentStream Investigations</b>
  <a href="agent-login.html" style="float:right">Agent Login</a>
</header>

<div class="container">
  <input id="search" placeholder="Search cases">
  <div id="cases"></div>
</div>

<script src="supabase.js"></script>
<script>
let page=0;

async function loadCases(){
  const q = document.getElementById("search").value;

  let req = supabase.from("cases")
    .select("*")
    .ilike("title", `%${q}%`)
    .range(page*10, page*10+9)
    .order("created_at",{ascending:false});

  const {data} = await req;

  const box=document.getElementById("cases");
  box.innerHTML="";

  data.forEach(c=>{
    box.innerHTML+=`
      <div class="card">
        <b>${c.case_number}</b> â€” ${c.title}<br>
        Status: ${c.status}<br>
        <a href="case.html?id=${c.id}">Open Case</a>
      </div>`;
  });
}

document.getElementById("search").oninput=loadCases;
loadCases();
</script>
</body>
</html>