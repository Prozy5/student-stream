<!DOCTYPE html>
<html lang="en">
<head>
  <!-- ===========================================
   STUDENTSTREAM STUDIOS • MARKETPLACE (LIVE V10000)
   Powered by StudentStream HQ + Supabase
  ============================================ -->

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />

  <title>Marketplace • StudentStream Studios</title>

  <!-- SEO -->
  <meta name="description"
    content="Browse the official StudentStream Studios Marketplace — digital work, creative assets, filmmaking services, and talent listings powered by StudentStream HQ." />

  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="https://studentstream.online/studios/marketplace.html" />

  <!-- Schema.org Marketplace -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "CollectionPage",
    "name": "StudentStream Studios Marketplace",
    "url": "https://studentstream.online/studios/marketplace.html",
    "description": "The official marketplace for creators, filmmakers, editors, designers, and digital talent inside StudentStream HQ.",
    "publisher": {
      "@type": "Organization",
      "name": "StudentStream HQ",
      "url": "https://studentstream.online"
    }
  }
  </script>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <!-- Styling -->
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Inter, sans-serif;
    }

    body {
      background: radial-gradient(circle at top, #14192c, #05060c);
      color: white;
      min-height: 100vh;
    }

    header {
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .brand {
      font-weight: 900;
      font-size: 18px;
    }

    nav a {
      color: white;
      text-decoration: none;
      opacity: 0.7;
      font-size: 14px;
      margin-left: 14px;
    }

    nav a:hover {
      opacity: 1;
    }

    .hero {
      max-width: 1100px;
      margin: auto;
      padding: 50px 20px 25px;
    }

    .pill {
      display: inline-block;
      padding: 8px 14px;
      border-radius: 999px;
      background: rgba(90, 255, 200, 0.10);
      border: 1px solid rgba(90, 255, 200, 0.20);
      color: #5cffc7;
      font-size: 13px;
      margin-bottom: 18px;
    }

    h1 {
      font-size: 42px;
      font-weight: 950;
      margin-bottom: 14px;
    }

    .sub {
      font-size: 17px;
      opacity: 0.75;
      max-width: 720px;
      line-height: 1.6;
    }

    .notice {
      margin-top: 20px;
      padding: 14px 16px;
      border-radius: 14px;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.08);
      font-size: 14px;
      opacity: 0.8;
    }

    .toolbar {
      max-width: 1100px;
      margin: auto;
      padding: 25px 20px;
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
    }

    .search {
      flex: 1;
      min-width: 220px;
      padding: 14px 16px;
      border-radius: 14px;
      border: none;
      outline: none;
      font-size: 15px;
    }

    .filter {
      padding: 14px 16px;
      border-radius: 14px;
      border: none;
      outline: none;
      font-size: 15px;
      background: rgba(255,255,255,0.06);
      color: white;
    }

    section {
      max-width: 1100px;
      margin: auto;
      padding: 15px 20px 60px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 18px;
      margin-top: 20px;
    }

    .item {
      padding: 18px;
      border-radius: 18px;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.08);
      transition: 0.2s ease;
    }

    .item:hover {
      transform: translateY(-4px);
      background: rgba(255,255,255,0.07);
    }

    .tag {
      display: inline-block;
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(91, 140, 255, 0.12);
      border: 1px solid rgba(91, 140, 255, 0.25);
      color: #5b8cff;
      margin-bottom: 10px;
    }

    .title {
      font-size: 16px;
      font-weight: 800;
      margin-bottom: 6px;
    }

    .desc {
      font-size: 14px;
      opacity: 0.7;
      line-height: 1.5;
      margin-bottom: 14px;
    }

    .meta {
      display: flex;
      justify-content: space-between;
      font-size: 13px;
      opacity: 0.6;
    }

    .status {
      opacity: 0.6;
      font-size: 14px;
      margin-top: 18px;
    }

    footer {
      padding: 35px 20px;
      text-align: center;
      font-size: 13px;
      opacity: 0.6;
      border-top: 1px solid rgba(255,255,255,0.06);
    }
  </style>
</head>

<body>

  <!-- Header -->
  <header>
    <div class="brand">
      StudentStream Studios
    </div>

    <nav>
      <a href="/studios/">Home</a>
      <a href="/studios/submit.html">Submit</a>
      <a href="/studios/login.html">Login</a>
      <a href="https://www.instagram.com/studentstreamhq/" target="_blank">Instagram</a>
      <a href="https://www.tiktok.com/@studentstreamhq" target="_blank">TikTok</a>
    </nav>
  </header>

  <!-- Hero -->
  <div class="hero">
    <div class="pill">Marketplace • Live Listings</div>

    <h1>Browse the Studios Marketplace</h1>

    <p class="sub">
      Discover creative services, digital assets, filmmaking talent, and modern creators inside the StudentStream HQ ecosystem.
    </p>

    <div class="notice">
      ⚡ Manual Creator Payouts Active — Automated payouts are currently being finalized.
    </div>
  </div>

  <!-- Search Toolbar -->
  <div class="toolbar">
    <input id="searchInput" class="search" placeholder="Search listings..." />

    <select id="categoryFilter" class="filter">
      <option value="all">All Categories</option>
      <option value="Digital Assets">Digital Assets</option>
      <option value="Video Editing">Video Editing</option>
      <option value="Design">Design</option>
      <option value="Music">Music</option>
      <option value="Film">Film</option>
    </select>
  </div>

  <!-- Marketplace -->
  <section>
    <h2 style="font-size:22px;font-weight:900;">Live Marketplace Drops</h2>

    <p id="status" class="status">Loading listings...</p>

    <div id="marketGrid" class="grid"></div>
  </section>

  <!-- Footer -->
  <footer>
    © <span id="year"></span> StudentStream HQ • Studios Marketplace
  </footer>

  <!-- Supabase + Marketplace Script -->
  <script>
    document.getElementById("year").textContent = new Date().getFullYear();

    // ✅ Supabase Config
    const SUPABASE_URL = "https://iabzmoxzbqzcqgypxctr.supabase.co";
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlhYnptb3h6YnF6Y3FneXB4Y3RyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcxMDgzNzAsImV4cCI6MjA4MjY4NDM3MH0.mHke56jh8WSlzzQxa7o2PIxqLRk1eyPRZerJ3avuGkQ";

    const supabase = window.supabase.createClient(
      SUPABASE_URL,
      SUPABASE_KEY
    );

    const grid = document.getElementById("marketGrid");
    const statusText = document.getElementById("status");

    let listings = [];

    // ✅ Load Marketplace Listings
    async function loadMarketplace() {
      statusText.textContent = "Loading listings...";

      const { data, error } = await supabase
        .from("studios_marketplace")
        .select("*")
        .order("created_at", { ascending: false });

      if (error) {
        statusText.textContent = "Error loading marketplace.";
        console.error(error);
        return;
      }

      listings = data;

      if (!listings.length) {
        statusText.textContent = "No listings yet. Be the first to submit.";
        return;
      }

      statusText.textContent = "";
      renderListings(listings);
    }

    // ✅ Render Listings
    function renderListings(items) {
      grid.innerHTML = "";

      items.forEach(item => {
        const card = document.createElement("div");
        card.className = "item";

        card.innerHTML = `
          <div class="tag">${item.category || "Listing"}</div>
          <div class="title">${item.title}</div>
          <div class="desc">${item.description || ""}</div>
          <div class="meta">
            <span>${item.creator_name || "Studios Creator"}</span>
            <span>$${item.price || "0"}</span>
          </div>
        `;

        grid.appendChild(card);
      });
    }

    // ✅ Search + Filter
    document.getElementById("searchInput").addEventListener("input", filterListings);
    document.getElementById("categoryFilter").addEventListener("change", filterListings);

    function filterListings() {
      const search = document.getElementById("searchInput").value.toLowerCase();
      const category = document.getElementById("categoryFilter").value;

      let filtered = listings.filter(item =>
        item.title.toLowerCase().includes(search)
      );

      if (category !== "all") {
        filtered = filtered.filter(item => item.category === category);
      }

      renderListings(filtered);
    }

    // ✅ Start
    loadMarketplace();
  </script>

</body>
</html>