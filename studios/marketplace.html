<!DOCTYPE html>
<html lang="en">
<head>
  <!-- =========================================
       STUDIOS MARKETPLACE (LOCKED v40000)
       StudentStream HQ ‚Ä¢ SS-Films Division
       Manual Monetization Club Active
       FULL SUPABASE INTEGRATION (FIXED)
       ========================================= -->

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
  <meta name="apple-mobile-web-app-capable" content="yes"/>

  <title>Studios Marketplace ‚Ä¢ StudentStream HQ</title>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    :root{
      --bg:#05060C;
      --panel:#0E1424;
      --text:#ECF2FF;
      --muted:#A9B4D0;
      --line:rgba(255,255,255,0.12);
      --accent:#5DA8FF;
      --accent2:#7C5CFF;
      --radius:24px;
    }

    *{
      margin:0;
      padding:0;
      box-sizing:border-box;
      font-family:system-ui,Segoe UI,Roboto,Arial;
    }

    body{
      background:
        radial-gradient(circle at top, rgba(93,168,255,0.14), transparent 70%),
        radial-gradient(circle at bottom, rgba(124,92,255,0.10), transparent 70%),
        var(--bg);
      color:var(--text);
      padding:32px 18px;
    }

    .wrap{
      max-width:1050px;
      margin:auto;
    }

    header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:55px;
    }

    .logo{
      font-weight:900;
      font-size:15px;
      opacity:0.92;
      display:flex;
      gap:8px;
      align-items:center;
    }

    nav a{
      margin-left:20px;
      font-size:14px;
      color:var(--muted);
      font-weight:700;
      text-decoration:none;
      transition:0.2s;
    }

    nav a:hover{
      color:white;
    }

    h1{
      font-size:56px;
      font-weight:1000;
      margin-bottom:14px;
      letter-spacing:-1px;
    }

    .sub{
      font-size:17px;
      color:var(--muted);
      max-width:650px;
      line-height:1.6;
      margin-bottom:38px;
    }

    .notice{
      padding:24px;
      border-radius:22px;
      border:1px solid rgba(255,255,255,0.12);
      background:rgba(255,255,255,0.05);
      margin-bottom:35px;
    }

    .notice h3{
      font-size:18px;
      font-weight:900;
      margin-bottom:10px;
    }

    .notice p{
      font-size:14px;
      color:var(--muted);
      line-height:1.5;
    }

    .grid{
      display:flex;
      flex-direction:column;
      gap:26px;
    }

    .card{
      padding:28px;
      border-radius:var(--radius);
      border:1px solid var(--line);
      background:rgba(14,20,36,0.78);
      box-shadow:0 0 25px rgba(0,0,0,0.35);
    }

    .card h2{
      font-size:24px;
      font-weight:1000;
      margin-bottom:10px;
    }

    .card p{
      color:var(--muted);
      font-size:14px;
      line-height:1.5;
      margin-bottom:18px;
    }

    .row{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:18px;
    }

    .tag{
      font-size:13px;
      color:rgba(255,255,255,0.55);
    }

    .price{
      font-size:26px;
      font-weight:1000;
      color:var(--accent);
    }

    button{
      width:100%;
      padding:16px;
      border-radius:999px;
      border:none;
      font-size:15px;
      font-weight:900;
      cursor:pointer;
      color:white;
      background:linear-gradient(135deg,var(--accent),var(--accent2));
      transition:0.25s;
    }

    button:hover{
      transform:translateY(-2px);
      opacity:0.95;
    }

    footer{
      margin-top:70px;
      padding-top:25px;
      border-top:1px solid rgba(255,255,255,0.10);
      text-align:center;
      font-size:13px;
      color:rgba(255,255,255,0.35);
    }

    @media(max-width:700px){
      h1{font-size:44px;}
    }
  </style>
</head>

<body>
<div class="wrap">

  <!-- HEADER -->
  <header>
    <div class="logo">üé¨ StudentStream Studios</div>

    <nav>
      <a href="/studios/index.html">Home</a>
      <a id="creatorLink" href="/studios/login.html">Creator Login</a>
    </nav>
  </header>

  <!-- HERO -->
  <h1>Studios Marketplace</h1>

  <p class="sub">
    Browse licensed creative assets, production packs, visuals,
    and SS-Films digital work.
  </p>

  <!-- NOTICE -->
  <div class="notice">
    <h3>Manual Purchase Requests Active</h3>
    <p>
      Checkout is currently handled manually while Stripe integration is being prepared.
      Click <b>Request Purchase</b> and the Studios team will contact you directly.
    </p>
  </div>

  <!-- PRODUCTS -->
  <div class="grid">

    <div class="card">
      <h2>Cinematic Visual Pack</h2>
      <p>HQ licensed visuals for productions, creators, and studios.</p>
      <div class="row">
        <span class="tag">Visual Assets</span>
        <span class="price">$25.00</span>
      </div>
      <button onclick="requestPurchase('Cinematic Visual Pack', 25)">
        Request Purchase
      </button>
    </div>

    <div class="card">
      <h2>SS-Films Trailer Template Pack</h2>
      <p>Professional motion intro templates built for film edits + studio trailers.</p>
      <div class="row">
        <span class="tag">Film Assets</span>
        <span class="price">$40.00</span>
      </div>
      <button onclick="requestPurchase('SS-Films Trailer Template Pack', 40)">
        Request Purchase
      </button>
    </div>

    <div class="card">
      <h2>Creator Brand Overlay Kit</h2>
      <p>Licensed overlays + lower-thirds for verified SS-Films creators.</p>
      <div class="row">
        <span class="tag">Creator Tools</span>
        <span class="price">$15.00</span>
      </div>
      <button onclick="requestPurchase('Creator Brand Overlay Kit', 15)">
        Request Purchase
      </button>
    </div>

  </div>

  <footer>
    ¬© 2026 StudentStream HQ ‚Äî Studios Marketplace ‚Ä¢ Manual Payments Active
  </footer>

</div>

<!-- =========================================
     SUPABASE + PURCHASE REQUESTS (FIXED)
========================================= -->
<script>
  const SUPABASE_URL = "https://iabzmoxzbqzcqgypxctr.supabase.co";
  const SUPABASE_ANON_KEY =
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlhYnptb3h6YnF6Y3FneXB4Y3RyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcxMDgzNzAsImV4cCI6MjA4MjY4NDM3MH0.mHke56jh8WSlzzQxa7o2PIxqLRk1eyPRZerJ3avuGkQ";

  const supabase = window.supabase.createClient(
    SUPABASE_URL,
    SUPABASE_ANON_KEY
  );

  async function checkSession(){
    const { data } = await supabase.auth.getSession();

    if(data.session){
      document.getElementById("creatorLink").textContent = "Dashboard";
      document.getElementById("creatorLink").href =
        "/studios/creator/dashboard.html";
    }
  }

  checkSession();

  // ‚úÖ FIXED PURCHASE REQUEST FUNCTION
  window.requestPurchase = async function(productName, price){

    const buyerName = prompt("Enter your name:");
    const buyerEmail = prompt("Enter your email:");

    if(!buyerName || !buyerEmail){
      alert("‚ùå Request cancelled.");
      return;
    }

    // ‚úÖ SAVE INTO SUPABASE WITH ERROR CHECK
    const { error } = await supabase
      .from("purchase_requests")
      .insert([
        {
          product_name: productName,
          price_usd: price,
          buyer_name: buyerName,
          buyer_email: buyerEmail,
          status: "Manual Payment Pending"
        }
      ]);

    if(error){
      alert("‚ùå Supabase Error:\n" + error.message);
      return;
    }

    // ‚úÖ SUCCESS FIRST
    alert("‚úÖ Request Submitted!\nStudios will contact you soon.");

    // ‚úÖ EMAIL FALLBACK (WORKS BETTER THAN location.href)
    window.open(
      `mailto:deondrechambers284@gmail.com?subject=New Studios Purchase Request&body=
NEW PURCHASE REQUEST

Product: ${productName}
Price: $${price}

Buyer Name: ${buyerName}
Buyer Email: ${buyerEmail}

Status: Manual Payment Pending

StudentStream Studios Marketplace`
    );
  };
</script>

</body>
</html>