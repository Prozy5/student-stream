<!DOCTYPE html>
<html lang="en">
<head>
  <!-- =========================================
       STUDIOS LOGIN • StudentStream HQ
       login.html (V10000 MAX LOCK)
       ========================================= -->

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  <title>Studios Login • StudentStream HQ</title>
  <meta name="description" content="Secure login portal for Studios division access inside StudentStream HQ." />

  <link rel="canonical" href="https://studentstream.online/studios/login.html" />

  <!-- =========================================
       STYLE — HQ GLASS LOGIN UI (UPGRADED)
       ========================================= -->
  <style>
    :root{
      --bg:#070A12;
      --panel:#0E1424;
      --text:#EAF0FF;
      --muted:#A9B4D0;
      --line:rgba(255,255,255,0.10);
      --accent:#5DA8FF;
      --accent2:#7C5CFF;
      --radius:18px;
      --good:#31D18B;
      --bad:#FF5C7A;
    }

    *{box-sizing:border-box;margin:0;padding:0;}

    body{
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:
        radial-gradient(circle at top, rgba(93,168,255,0.18), transparent 55%),
        radial-gradient(circle at right, rgba(124,92,255,0.12), transparent 55%),
        var(--bg);
      color:var(--text);
      min-height:100vh;
      display:flex;
      justify-content:center;
      align-items:center;
      padding:20px;
    }

    .box{
      width:100%;
      max-width:420px;
      background:rgba(14,20,36,0.82);
      border:1px solid var(--line);
      border-radius:var(--radius);
      padding:26px;
      backdrop-filter:blur(14px);
      box-shadow:0 30px 90px rgba(0,0,0,0.65);
    }

    h1{
      font-size:20px;
      font-weight:900;
      margin-bottom:6px;
    }

    p{
      font-size:13px;
      color:var(--muted);
      margin-bottom:18px;
      line-height:1.4;
    }

    label{
      display:block;
      font-size:13px;
      margin-bottom:6px;
      color:var(--muted);
    }

    input{
      width:100%;
      padding:12px 14px;
      border-radius:14px;
      border:1px solid var(--line);
      background:rgba(255,255,255,0.03);
      color:var(--text);
      outline:none;
      margin-bottom:14px;
      font-size:14px;
    }

    input:focus{
      border-color:rgba(93,168,255,0.45);
      box-shadow:0 0 0 4px rgba(93,168,255,0.15);
    }

    .btn{
      width:100%;
      padding:12px;
      border:none;
      border-radius:14px;
      background:linear-gradient(90deg,var(--accent),var(--accent2));
      color:white;
      font-weight:900;
      cursor:pointer;
      transition:0.2s;
      font-size:14px;
    }

    .btn:hover{
      transform:translateY(-1px);
      opacity:0.95;
    }

    .btn:disabled{
      opacity:0.5;
      cursor:not-allowed;
    }

    .status{
      margin-top:14px;
      font-size:13px;
      text-align:center;
      color:var(--muted);
    }

    .status.good{color:var(--good);font-weight:800;}
    .status.bad{color:var(--bad);font-weight:800;}

    .mini{
      margin-top:16px;
      text-align:center;
      font-size:12px;
      color:var(--muted);
    }

    .mini a{
      color:var(--accent);
      font-weight:700;
      text-decoration:none;
    }

    .togglePass{
      font-size:12px;
      color:var(--accent);
      cursor:pointer;
      margin-top:-8px;
      margin-bottom:14px;
      display:inline-block;
    }
  </style>
</head>

<body>

  <div class="box">
    <h1>Studios Access Portal</h1>
    <p>
      Secure login required.  
      Only approved accounts can enter the Studios dashboard.
    </p>

    <!-- LOGIN FORM -->
    <form id="loginForm">
      <label>Email</label>
      <input id="email" type="email" placeholder="you@domain.com" required />

      <label>Password</label>
      <input id="password" type="password" placeholder="••••••••••" required />

      <span class="togglePass" id="togglePass">
        Show Password
      </span>

      <button class="btn" id="loginBtn" type="submit">
        Sign In
      </button>
    </form>

    <div id="status" class="status">
      Waiting…
    </div>

    <div class="mini">
      Back to <a href="/">Main Site</a>
    </div>
  </div>

  <!-- =========================================
       SUPABASE LOGIN (SESSION FIXED + LOCKED)
       ========================================= -->
  <script type="module">
    import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

    const SUPABASE_URL = "https://iabzmoxzbqzcqgypxctr.supabase.co";
    const SUPABASE_ANON_KEY =
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlhYnptb3h6YnF6Y3FneXB4Y3RyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcxMDgzNzAsImV4cCI6MjA4MjY4NDM3MH0.mHke56jh8WSlzzQxa7o2PIxqLRk1eyPRZerJ3avuGkQ";

    /* ✅ FIX: Session persistence so login doesn’t reset */
    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {
      auth: {
        persistSession: true,
        autoRefreshToken: true,
        detectSessionInUrl: true
      }
    });

    const statusBox = document.getElementById("status");
    const loginBtn = document.getElementById("loginBtn");

    /* ✅ Redirect target */
    const DASHBOARD_URL = "/studios/dashboard.html";

    /* ✅ SESSION CHECK */
    const { data: sessionData } = await supabase.auth.getSession();

    if (sessionData.session) {
      statusBox.textContent = "Already signed in. Redirecting…";
      statusBox.className = "status good";

      setTimeout(() => {
        window.location.replace(DASHBOARD_URL);
      }, 800);
    }

    /* ✅ Password toggle */
    document.getElementById("togglePass").onclick = () => {
      const pass = document.getElementById("password");

      if (pass.type === "password") {
        pass.type = "text";
        togglePass.textContent = "Hide Password";
      } else {
        pass.type = "password";
        togglePass.textContent = "Show Password";
      }
    };

    /* ✅ LOGIN SUBMIT */
    document.getElementById("loginForm").addEventListener("submit", async (e) => {
      e.preventDefault();

      loginBtn.disabled = true;
      statusBox.textContent = "Signing in…";
      statusBox.className = "status";

      const email = document.getElementById("email").value.trim();
      const password = document.getElementById("password").value.trim();

      const { error } = await supabase.auth.signInWithPassword({
        email,
        password
      });

      if (error) {
        statusBox.textContent = "Login failed: " + error.message;
        statusBox.className = "status bad";
        loginBtn.disabled = false;
        return;
      }

      statusBox.textContent = "Success. Redirecting…";
      statusBox.className = "status good";

      setTimeout(() => {
        window.location.replace(DASHBOARD_URL);
      }, 700);
    });
  </script>

</body>
</html>