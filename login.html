<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Login • StudentStreamHQ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- SEO -->
  <meta name="description"
    content="Login to StudentStreamHQ — DevForum, SS:Watch, Originals, Monetization, and your full creator dashboard." />

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont;
      min-height: 100vh;
      background: radial-gradient(circle at top, #0d1b3a, #05070c);
      display: flex;
      justify-content: center;
      align-items: center;
      color: white;
      overflow: hidden;
    }

    /* BACKGROUND GLOWS */
    .glow {
      position: absolute;
      width: 750px;
      height: 750px;
      background: radial-gradient(circle, rgba(77,163,255,.25), transparent 70%);
      filter: blur(90px);
      top: -250px;
      left: -250px;
    }

    .glow2 {
      position: absolute;
      width: 750px;
      height: 750px;
      background: radial-gradient(circle, rgba(60,255,122,.18), transparent 70%);
      filter: blur(95px);
      bottom: -250px;
      right: -250px;
    }

    /* LOGIN BOX */
    .loginWrap {
      width: 100%;
      max-width: 440px;
      padding: 42px;
      border-radius: 28px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      backdrop-filter: blur(22px);
      z-index: 10;
      box-shadow: 0 0 70px rgba(0,0,0,.45);
    }

    /* BRAND */
    .brand {
      text-align: center;
      margin-bottom: 28px;
    }

    .brand h1 {
      font-size: 48px;
      font-weight: 950;
      letter-spacing: -.5px;
    }

    .brand h1 span {
      color: #4da3ff;
    }

    .brand p {
      margin-top: 10px;
      font-size: 14px;
      opacity: .65;
      line-height: 1.5;
    }

    /* FORM */
    label {
      display: block;
      margin-top: 18px;
      font-size: 13px;
      font-weight: 750;
      opacity: .75;
    }

    input {
      width: 100%;
      margin-top: 8px;
      padding: 14px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.03);
      color: white;
      outline: none;
      font-size: 14px;
      transition: .2s;
    }

    input:focus {
      border-color: rgba(77,163,255,.60);
      box-shadow: 0 0 0 2px rgba(77,163,255,.15);
    }

    /* BUTTON */
    button {
      width: 100%;
      margin-top: 26px;
      padding: 14px;
      border-radius: 16px;
      border: none;
      cursor: pointer;
      font-weight: 950;
      font-size: 15px;
      background: linear-gradient(90deg,#4da3ff,#3cff7a);
      color: black;
      transition: .2s;
    }

    button:hover {
      opacity: .92;
      transform: scale(1.01);
    }

    /* STATUS */
    .status {
      margin-top: 14px;
      text-align: center;
      font-size: 14px;
      opacity: .75;
    }

    /* LINKS */
    .extras {
      text-align: center;
      margin-top: 20px;
      font-size: 13px;
      opacity: .6;
    }

    .extras a {
      color: white;
      text-decoration: none;
      font-weight: 750;
      opacity: .75;
    }

    .extras a:hover {
      opacity: 1;
    }
  </style>
</head>

<body>

  <!-- Glow Background -->
  <div class="glow"></div>
  <div class="glow2"></div>

  <!-- Login Box -->
  <div class="loginWrap">

    <!-- Brand -->
    <div class="brand">
      <h1>StudentStream<span>HQ</span></h1>
      <p>
        One login for everything.<br>
        DevForum • SS:Watch • Originals • Monetization • Dashboard
      </p>
    </div>

    <!-- Login Form -->
    <label>Email</label>
    <input id="email" type="email" placeholder="you@studentstream.com">

    <label>Password</label>
    <input id="password" type="password" placeholder="••••••••">

    <button onclick="loginUser()">Login</button>

    <div class="status" id="statusText"></div>

    <div class="extras">
      <br>
      New here? <a href="/signup.html">Create Account</a><br><br>
      <a href="/devforum">← Back to DevForum</a>
    </div>

  </div>

  <!-- Supabase Auth Script -->
  <script type="module">
    import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

    const supabase = createClient(
      "https://iabzmoxzbqzcqgypxctr.supabase.co",
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlhYnptb3h6YnF6Y3RyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcxMDgzNzAsImV4cCI6MjA4MjY4NDM3MH0.mHke56jh8WSlzzQxa7o2PIxqLRk1eyPRZerJ3avuGkQ"
    );

    /* ✅ Redirect System */
    const params = new URLSearchParams(window.location.search);

    /* If user came from somewhere */
    const nextPage = params.get("next");

    /* Default destination */
    const defaultDashboard = "/dashboard.html";

    /* Final redirect target */
    const redirectTo = nextPage || defaultDashboard;

    /* ✅ Auto-skip login if already signed in */
    const { data: sessionData } = await supabase.auth.getSession();

    if (sessionData.session) {
      window.location.href = redirectTo;
    }

    /* ✅ Login Function */
    window.loginUser = async function () {
      const email = document.getElementById("email").value.trim();
      const password = document.getElementById("password").value.trim();
      const status = document.getElementById("statusText");

      if (!email || !password) {
        status.textContent = "⚠️ Please enter email + password.";
        return;
      }

      status.textContent = "Logging in...";

      const { error } = await supabase.auth.signInWithPassword({
        email,
        password
      });

      if (error) {
        status.textContent = "❌ Login failed: " + error.message;
        return;
      }

      status.textContent = "✅ Welcome back to StudentStreamHQ.";

      setTimeout(() => {
        window.location.href = redirectTo;
      }, 900);
    };
  </script>

</body>
</html>