<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Join SS Films</title>

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui;
  background:#05070c;
  color:#fff;
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
}

.box{
  width:100%;
  max-width:420px;
  background:#0e1522;
  padding:26px;
  border-radius:16px;
  border:1px solid #1f2630;
}

h1{
  margin-top:0;
  font-size:26px;
  color:#3ea6ff;
}

p{opacity:.8;font-size:14px}

input{
  width:100%;
  padding:12px;
  margin-top:12px;
  border-radius:10px;
  border:none;
  background:#1a2230;
  color:#fff;
}

button{
  width:100%;
  margin-top:16px;
  padding:12px;
  border:none;
  border-radius:10px;
  background:#1e90ff;
  color:#fff;
  font-weight:700;
  cursor:pointer;
}

.msg{
  margin-top:14px;
  font-size:14px;
}

.success{color:#3cff8f}
.error{color:#ff6b6b}

.small{
  font-size:13px;
  opacity:.7;
  margin-top:10px;
}
</style>
</head>
<body>

<div class="box">
  <h1>Join SS Films</h1>
  <p>Create your account and apply to become a verified creator.</p>

  <input id="name" placeholder="Creator / Channel name">
  <input id="email" type="email" placeholder="Email">
  <input id="password" type="password" placeholder="Password">

  <button id="signupBtn">Create account</button>

  <div id="msg" class="msg"></div>

  <div class="small">
    Already have an account? <a href="login.html" style="color:#3ea6ff">Login</a>
  </div>
</div>

<script type="module">
import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

const supabase = createClient(
  "https://iabzmoxzbqzcqgypxctr.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlhYnptb3h6YnF6Y3FneXB4Y3RyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcxMDgzNzAsImV4cCI6MjA4MjY4NDM3MH0.mHke56jh8WSlzzQxa7o2PIxqLRk1eyPRZerJ3avuGkQ"
);

const nameEl = document.getElementById("name");
const emailEl = document.getElementById("email");
const passEl = document.getElementById("password");
const btn = document.getElementById("signupBtn");
const msg = document.getElementById("msg");

btn.onclick = async () => {
  msg.textContent = "";
  btn.disabled = true;

  const name = nameEl.value.trim();
  const email = emailEl.value.trim();
  const password = passEl.value;

  if(!name || !email || !password){
    show("Fill all fields","error");
    btn.disabled=false;
    return;
  }

  /* Create auth account */
  const { data, error } = await supabase.auth.signUp({
    email,
    password
  });

  if(error){
    show(error.message,"error");
    btn.disabled=false;
    return;
  }

  const user = data.user;

  /* Create creator request */
  const { error: creatorErr } = await supabase.from("creators").insert({
    user_id: user.id,
    name: name,
    status: "pending"
  });

  if(creatorErr){
    show("Account created but creator request failed","error");
    btn.disabled=false;
    return;
  }

  show("âœ… Application sent! You'll receive an email when approved.","success");

  setTimeout(()=>{
    location.href="login.html";
  },2500);
};

function show(text,type){
  msg.textContent=text;
  msg.className="msg "+type;
}
</script>

</body>
</html>