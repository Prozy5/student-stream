<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SS Films ‚Ä¢ Originals. Spotlight. Legacy.</title>

  <!-- Supabase v2 -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    :root{
      --bg:#05060c;
      --panel:rgba(255,255,255,.04);
      --line:rgba(255,255,255,.10);
      --text:#fff;
      --muted:rgba(255,255,255,.65);
      --accent:#3b82f6;
      --radius:20px;
    }

    *{margin:0;padding:0;box-sizing:border-box;font-family:system-ui;}

    body{
      background:radial-gradient(circle at top,#0b1022,#05060c);
      color:var(--text);
      overflow-x:hidden;
    }

    header{
      position:sticky;
      top:0;
      z-index:99;
      padding:18px 26px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      background:rgba(5,6,12,.92);
      backdrop-filter:blur(14px);
      border-bottom:1px solid var(--line);
    }

    .logo{
      font-weight:1000;
      font-size:15px;
      letter-spacing:.5px;
    }

    nav a{
      margin-left:18px;
      text-decoration:none;
      font-size:13px;
      font-weight:850;
      color:var(--muted);
    }
    nav a:hover{color:white;}

    .hero{
      max-width:1150px;
      margin:auto;
      padding:80px 25px 40px;
    }

    .tag{
      display:inline-block;
      padding:7px 18px;
      border-radius:999px;
      font-size:13px;
      font-weight:800;
      background:rgba(59,130,246,.15);
      border:1px solid rgba(59,130,246,.30);
      color:#7aa2ff;
      margin-bottom:18px;
    }

    h1{
      font-size:64px;
      font-weight:1000;
      line-height:1.05;
    }

    .hero p{
      margin-top:18px;
      max-width:720px;
      font-size:16px;
      line-height:1.7;
      color:var(--muted);
    }

    .spotlight{
      margin-top:35px;
      padding:26px;
      border-radius:var(--radius);
      border:1px solid var(--line);
      background:var(--panel);
    }

    .spotlight h2{
      font-size:28px;
      font-weight:1000;
    }

    .spotlightBtn{
      margin-top:16px;
      display:inline-block;
      padding:13px 24px;
      border-radius:999px;
      font-weight:900;
      text-decoration:none;
      background:linear-gradient(135deg,#3b82f6,#6cf2c2);
      color:black;
    }

    .section{
      max-width:1200px;
      margin:auto;
      padding:35px 25px;
    }

    .section h3{
      font-size:20px;
      font-weight:1000;
      margin-bottom:14px;
    }

    .row{
      display:flex;
      gap:16px;
      overflow-x:auto;
      padding-bottom:12px;
    }

    .card{
      min-width:240px;
      border-radius:18px;
      overflow:hidden;
      border:1px solid var(--line);
      background:var(--panel);
      cursor:pointer;
      transition:.25s;
    }

    .card:hover{
      transform:scale(1.05);
      border-color:rgba(59,130,246,.45);
    }

    .card img{
      width:100%;
      height:145px;
      object-fit:cover;
    }

    .info{
      padding:12px;
    }

    .info h4{
      margin:0;
      font-size:14px;
      font-weight:900;
    }

    .info p{
      margin-top:5px;
      font-size:12px;
      opacity:.65;
    }

    /* Debug Error Box */
    .debugBox{
      max-width:1150px;
      margin:20px auto;
      padding:14px 18px;
      border-radius:14px;
      border:1px solid rgba(255,0,0,.35);
      background:rgba(255,0,0,.08);
      color:#ffb3b3;
      display:none;
      font-size:13px;
      line-height:1.4;
    }

    footer{
      margin-top:60px;
      padding:35px;
      text-align:center;
      font-size:13px;
      opacity:.4;
      border-top:1px solid var(--line);
    }
  </style>
</head>

<body>

<header>
  <div class="logo">üé¨ SS Films ‚Ä¢ StudentStream HQ</div>
  <nav>
    <a href="/ss-productions/">Productions</a>
    <a href="/boosts.html">Boosts</a>
    <a id="loginLink" href="/ss-films/login.html">Login</a>
  </nav>
</header>

<div class="debugBox" id="debugBox"></div>

<section class="hero">
  <span class="tag">Originals ‚Ä¢ Spotlight ‚Ä¢ Legacy</span>
  <h1>SS Films Originals.</h1>
  <p>
    Creator-made movies, episodic series, documentaries, and platform Originals.
    Browse freely ‚Äî watching is unlocked after login.
  </p>

  <div class="spotlight">
    <h2 id="spotlightTitle">Loading Spotlight‚Ä¶</h2>
    <p style="opacity:.65;margin-top:6px;">Featured Premiere</p>
    <a class="spotlightBtn" id="spotlightBtn" href="#">
      Watch Spotlight ‚Üí
    </a>
  </div>
</section>

<section class="section">
  <h3>üçø Movies</h3>
  <div class="row" id="moviesRow"></div>
</section>

<section class="section">
  <h3>üì∫ Series</h3>
  <div class="row" id="seriesRow"></div>
</section>

<section class="section">
  <h3>üé• Documentaries</h3>
  <div class="row" id="docsRow"></div>
</section>

<footer>
  ¬© 2026 StudentStream HQ ‚Äî SS Films Division<br/>
  Originals. Spotlight. Legacy.
</footer>

<script>
/* ==========================================
   SUPABASE CONFIG (MATCHES YOUR DB)
========================================== */

const SUPABASE_URL = "https://iabzmoxzbqzcqgypxctr.supabase.co";
const SUPABASE_KEY =
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlhYnptb3h6YnF6Y3FneXB4Y3RyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcxMDgzNzAsImV4cCI6MjA4MjY4NDM3MH0.mHke56jh8WSlzzQxa7o2PIxqLRk1eyPRZerJ3avuGkQ";

/* ‚úÖ Correct Initialization */
const supabase = window.supabase.createClient(
  SUPABASE_URL,
  SUPABASE_KEY
);

/* Debug UI */
const debugBox = document.getElementById("debugBox");
function showError(msg){
  debugBox.style.display="block";
  debugBox.innerText = msg;
  console.error(msg);
}

/* Rows */
const moviesRow = document.getElementById("moviesRow");
const seriesRow = document.getElementById("seriesRow");
const docsRow   = document.getElementById("docsRow");

/* ==========================================
   AUTH NAV FIX
========================================== */
async function checkSession(){
  const { data } = await supabase.auth.getSession();
  if(data.session){
    document.getElementById("loginLink").textContent="Dashboard";
    document.getElementById("loginLink").href="/ss-films/dashboard.html";
  }
}
checkSession();

/* ==========================================
   CARD RENDER
========================================== */
function renderCard(film, row){
  const card = document.createElement("div");
  card.className="card";

  card.innerHTML=`
    <img src="${film.thumbnail_url}" />
    <div class="info">
      <h4>${film.title}</h4>
      <p>${film.category} ‚Ä¢ ${film.genre || "SS Original"}</p>
    </div>
  `;

  card.onclick = async () => {
    const { data } = await supabase.auth.getSession();
    if(!data.session){
      window.location.href =
        "/ss-films/login.html?redirect=watch&id=" + film.id;
      return;
    }
    window.location.href =
      "/ss-films/watch.html?id=" + film.id;
  };

  row.appendChild(card);
}

/* ==========================================
   LOAD FILMS (NO FILTERS)
========================================== */
async function loadHome(){
  console.log("Loading films...");

  const { data: films, error } = await supabase
    .from("films")
    .select("*")
    .order("created_at",{ascending:false});

  console.log("FILMS:", films);

  if(error){
    showError("Supabase Error: " + error.message);
    return;
  }

  if(!films || films.length===0){
    showError("No films found in table.");
    return;
  }

  /* Spotlight = Featured or newest */
  let spotlight = films.find(f => f.featured === true) || films[0];

  document.getElementById("spotlightTitle").textContent =
    spotlight.title;

  document.getElementById("spotlightBtn").href =
    "/ss-films/login.html?redirect=watch&id=" + spotlight.id;

  /* Fill rows */
  films.forEach(film=>{
    const cat = (film.category || "").toLowerCase();

    if(cat.includes("series")){
      renderCard(film, seriesRow);
    }
    else if(cat.includes("documentary")){
      renderCard(film, docsRow);
    }
    else{
      renderCard(film, moviesRow);
    }
  });
}

loadHome();
</script>

</body>
</html>