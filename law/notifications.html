<!DOCTYPE html>
<html>
<head>
  <title>Notifications Â· StudentStream</title>
</head>
<body style="background:#05080f;color:white;font-family:system-ui;padding:40px;">

<h1>ðŸ“© Enforcement Notifications</h1>
<p style="opacity:.7">
Official enforcement and safety notices.
</p>

<div id="notifBox">Loading...</div>

<script type="module">
import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

const supabase = createClient(
  "https://iabzmoxzbqzcqgypxctr.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlhYnptb3h6YnF6Y3FneXB4Y3RyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcxMDgzNzAsImV4cCI6MjA4MjY4NDM3MH0.mHke56jh8WSlzzQxa7o2PIxqLRk1eyPRZerJ3avuGkQ"
);

async function loadNotifs(){

  const { data:{user} } = await supabase.auth.getUser();
  if(!user){
    location.href="/login.html";
    return;
  }

  const { data:notifs } = await supabase
    .from("law_notifications")
    .select("*")
    .order("created_at",{ascending:false});

  const box=document.getElementById("notifBox");

  if(!notifs || notifs.length===0){
    box.innerHTML="No notifications.";
    return;
  }

  box.innerHTML="";

  notifs.forEach(n=>{
    box.innerHTML += `
      <div style="
        margin-top:14px;
        padding:14px;
        border:1px solid rgba(255,255,255,.12);
        border-radius:14px;
        background:rgba(255,255,255,.03);
      ">
        <b>${n.title}</b><br>
        ${n.message}<br>
        <small style="opacity:.6">
          ${new Date(n.created_at).toLocaleString()}
        </small>
      </div>
    `;
  });
}

loadNotifs();
</script>

</body>
</html>