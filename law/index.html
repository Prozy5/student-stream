<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>StudentStream Law Division</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script type="module" src="/js/platform-guard.js"></script>

<style>
:root{
  --bg:#05080f;
  --panel:#0c1626;
  --panel2:#101f35;
  --accent:#ff5d5d;
  --accent2:#ff2f2f;
  --text:#eaf1ff;
  --muted:#9fb0cc;
  --border:rgba(255,255,255,0.08);
}

*{margin:0;padding:0;box-sizing:border-box}

body{
  font-family:system-ui;
  background:radial-gradient(circle at top,#0c1b33,#05080f 75%);
  color:var(--text);
}

/* NAV */
nav{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:18px 26px;
  background:rgba(10,20,40,.85);
  backdrop-filter:blur(14px);
  border-bottom:1px solid var(--border);
}

.brand{
  font-weight:950;
  font-size:16px;
  display:flex;
  align-items:center;
  gap:10px;
}

.nav-links a{
  margin-left:18px;
  color:var(--muted);
  text-decoration:none;
  font-size:14px;
  font-weight:650;
}

.nav-links a:hover{color:var(--text)}

/* HERO */
.hero{
  max-width:1120px;
  margin:auto;
  padding:85px 22px 55px;
  text-align:center;
}

.hero h1{
  font-size:58px;
  font-weight:990;
}

.hero span{color:var(--accent)}

.hero p{
  max-width:880px;
  margin:18px auto;
  color:var(--muted);
  font-size:15px;
  line-height:1.75;
}

/* OFFICIAL BANNER */
.govBanner{
  margin:28px auto 0;
  max-width:880px;
  padding:16px 18px;
  border-radius:16px;
  border:1px solid rgba(255,93,93,.25);
  background:rgba(255,93,93,.06);
  font-size:13.5px;
  color:var(--muted);
}

.govBanner strong{
  color:var(--accent);
}

/* CHIEF */
.chiefHighlight{
  margin:35px auto 0;
  max-width:880px;
  padding:20px;
  border-radius:18px;
  border:1px solid rgba(255,93,93,.35);
  background:linear-gradient(
    135deg,
    rgba(255,93,93,.14),
    rgba(12,22,38,.92)
  );
  text-align:left;
}

.chiefHighlight h3{
  font-size:15px;
  font-weight:950;
}

.chiefName{
  margin-top:8px;
  font-size:16px;
  font-weight:950;
  color:var(--text);
}

.chiefBadge{
  display:inline-block;
  margin-top:10px;
  padding:6px 12px;
  border-radius:999px;
  font-size:12px;
  font-weight:950;
  background:linear-gradient(135deg,var(--accent),var(--accent2));
  color:#200000;
}

/* BUTTONS */
.hero-actions{
  margin-top:34px;
  display:flex;
  justify-content:center;
  gap:14px;
  flex-wrap:wrap;
}

.btn{
  padding:13px 22px;
  border-radius:14px;
  border:1px solid var(--border);
  background:var(--panel);
  color:var(--text);
  text-decoration:none;
  font-weight:850;
  transition:.2s;
}

.btn.primary{
  background:linear-gradient(135deg,var(--accent),var(--accent2));
  border:none;
  color:#200000;
}

.btn:hover{
  transform:translateY(-2px);
  opacity:.92;
}

/* METRICS */
.metricsGrid{
  margin:45px auto 0;
  max-width:980px;
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(230px,1fr));
  gap:14px;
}

.metricCard{
  padding:18px;
  border-radius:18px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.02);
  text-align:left;
}

.metricCard h2{
  font-size:26px;
  font-weight:990;
  margin-top:6px;
}

.metricCard span{
  font-size:13px;
  color:var(--muted);
}

/* ACTIVITY FEED */
.feed{
  margin:60px auto 0;
  max-width:920px;
  text-align:left;
}

.feed h2{
  font-size:20px;
  font-weight:950;
  margin-bottom:14px;
}

.feedBox{
  padding:16px;
  border-radius:16px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.02);
  margin-bottom:14px;
  font-size:14px;
  color:var(--muted);
}

.feedBox strong{
  color:var(--accent);
}

/* STAFF PANEL */
.staffPanel{
  margin:40px auto 0;
  max-width:780px;
  padding:22px;
  border-radius:20px;
  border:1px solid rgba(255,93,93,.35);
  background:rgba(255,93,93,.07);
  display:none;
  text-align:left;
}

.staffPanel h3{
  font-size:17px;
  font-weight:990;
}

.staffPanel a{
  display:inline-block;
  margin-top:14px;
  padding:11px 16px;
  border-radius:14px;
  background:linear-gradient(135deg,var(--accent),var(--accent2));
  font-weight:950;
  color:#200000;
  text-decoration:none;
}

/* FOOTER */
footer{
  text-align:center;
  padding:40px;
  border-top:1px solid var(--border);
  margin-top:80px;
  font-size:13px;
  color:var(--muted);
}
</style>
</head>

<body>

<!-- NAV -->
<nav>
  <div class="brand">‚öñÔ∏è StudentStream Law Division</div>

  <div class="nav-links">
    <a href="../index.html">Home</a>
    <a href="report.html">Report</a>
    <a href="my-reports.html">My Reports</a>
    <a href="staff-transparency.html">Staff Registry</a>
    <a href="law-login.html">Staff Access</a>
  </div>
</nav>

<!-- HERO -->
<section class="hero">

  <h1>StudentStream <span>Law</span></h1>

  <p>
    StudentStreamHQ‚Äôs verified enforcement and creator safety division.
    Reports are reviewed internally, assigned to investigators, and handled securely.
  </p>

  <div class="govBanner">
    <strong>Enforcement Workflow:</strong>
    Reports remain pending until a verified staff investigator is assigned.
  </div>

  <!-- CHIEF -->
  <div class="chiefHighlight">
    <h3>‚≠ê Verified Chief Authority</h3>
    <div class="chiefName" id="chiefName">Loading Chief...</div>
    <div class="chiefBadge">‚úî VERIFIED CHIEF COMMAND</div>
  </div>

  <!-- ACTIONS -->
  <div class="hero-actions">
    <a href="report.html" class="btn primary">üö® Submit Report</a>
    <a href="my-reports.html" class="btn">üìå Track My Reports</a>
    <a href="appeals.html" class="btn">‚ö† Appeals</a>
  </div>

  <!-- METRICS -->
  <div class="metricsGrid">
    <div class="metricCard">
      <span>Total Reports Filed</span>
      <h2 id="metricReports">‚Äî</h2>
    </div>

    <div class="metricCard">
      <span>Cases Assigned</span>
      <h2 id="metricAssigned">‚Äî</h2>
    </div>

    <div class="metricCard">
      <span>Evidence Vault</span>
      <h2>SECURE</h2>
    </div>
  </div>

  <!-- STAFF PANEL -->
  <div class="staffPanel" id="staffPanel">
    <h3>‚öñÔ∏è Staff Command Access</h3>
    You are verified enforcement staff.<br>
    Open internal investigation tools below.
    <br>
    <a href="law-dashboard.html">Open Law Dashboard ‚Üí</a>
  </div>

  <!-- FEED -->
  <div class="feed">
    <h2>Enforcement Activity</h2>

    <div class="feedBox">
      <strong>Case Assignment Enabled:</strong>
      Reports now enter review before investigator assignment.
    </div>

    <div class="feedBox">
      <strong>Evidence Upload Restricted:</strong>
      Vault uploads are only accessible to assigned staff.
    </div>

    <div class="feedBox">
      <strong>Staff Registry Live:</strong>
      Verified enforcement ranks are now visible publicly.
    </div>
  </div>

</section>

<footer>
  ¬© 2026 StudentStreamHQ Law Division ¬∑ Enforcement & Creator Protection
</footer>

<!-- SUPABASE -->
<script type="module">
import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

const supabase = createClient(
  "https://iabzmoxzbqzcqgypxctr.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlhYnptb3h6YnF6Y3FneXB4Y3RyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcxMDgzNzAsImV4cCI6MjA4MjY4NDM3MH0.mHke56jh8WSlzzQxa7o2PIxqLRk1eyPRZerJ3avuGkQ"
);

async function loadMetrics(){

  const { count:reports } = await supabase
    .from("law_cases")
    .select("*", { count:"exact", head:true });

  const { count:assigned } = await supabase
    .from("law_cases")
    .select("*", { count:"exact", head:true })
    .not("assigned_to", "is", null);

  document.getElementById("metricReports").textContent = reports ?? "0";
  document.getElementById("metricAssigned").textContent = assigned ?? "0";
}

async function loadChief(){

  const { data:chief } = await supabase
    .from("profiles")
    .select("username")
    .eq("law_rank", "chief")
    .single();

  document.getElementById("chiefName").textContent =
    chief?.username ?? "Chief Authority Unlisted";
}

async function detectStaff(){

  const { data:{user} } = await supabase.auth.getUser();
  if(!user) return;

  const { data:profile } = await supabase
    .from("profiles")
    .select("law_rank")
    .eq("id", user.id)
    .single();

  if(profile?.law_rank && profile.law_rank !== "none"){
    document.getElementById("staffPanel").style.display="block";
  }
}

loadMetrics();
loadChief();
detectStaff();
</script>

</body>
</html>