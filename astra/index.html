<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ASTRA — Autonomous Signal Intelligence</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
:root{
--bg:#04050c;
--panel:rgba(15,20,40,0.6);
--border:rgba(255,255,255,0.08);
--text:#f5f7ff;
--muted:#8b95c9;
--accent:#4da3ff;
--success:#3cff9c;
--danger:#ff4d6d;
}

*{margin:0;padding:0;box-sizing:border-box;font-family:Inter,system-ui}
body{
background:radial-gradient(circle at 20% 10%,#101935,#000 70%);
color:var(--text);
overflow-x:hidden;
}

header{
position:fixed;
top:0;
width:100%;
padding:18px 40px;
backdrop-filter:blur(25px);
background:rgba(0,0,0,0.7);
border-bottom:1px solid var(--border);
display:flex;
justify-content:space-between;
align-items:center;
z-index:10;
}

header h1{
font-size:12px;
letter-spacing:4px;
}

.clock{
font-size:12px;
color:var(--muted);
}

.wrap{
max-width:1300px;
margin:auto;
padding:160px 20px 100px;
}

.section{margin-top:120px;}

.hero h2{
font-size:90px;
font-weight:900;
letter-spacing:-3px;
background:linear-gradient(90deg,#fff,var(--accent));
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
}

.hero p{
max-width:700px;
margin-top:20px;
line-height:1.8;
color:var(--muted);
}

.grid{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
gap:25px;
margin-top:40px;
}

.card{
background:var(--panel);
border:1px solid var(--border);
border-radius:20px;
padding:25px;
transition:.3s;
}

.card:hover{
border-color:var(--accent);
transform:translateY(-4px);
}

.card h4{
margin-bottom:10px;
}

.badge{
display:inline-block;
padding:3px 10px;
font-size:10px;
border-radius:999px;
margin-left:8px;
}

.classified{
background:var(--danger);
}

.active{
background:var(--success);
color:black;
}

.terminal{
margin-top:40px;
background:#000;
border:1px solid var(--accent);
border-radius:16px;
padding:20px;
font-family:monospace;
font-size:12px;
color:#7ecbff;
height:160px;
overflow:auto;
}

button{
padding:10px 18px;
border-radius:10px;
border:1px solid var(--accent);
background:transparent;
color:var(--accent);
cursor:pointer;
margin-top:10px;
}
button:hover{
background:var(--accent);
color:black;
}
</style>
</head>
<body>

<header>
<h1>ASTRA · SIGNAL INTELLIGENCE</h1>
<div class="clock" id="clock"></div>
</header>

<div class="wrap">

<section class="hero">
<h2>ASTRA</h2>
<p>
Autonomous anomaly modeling and research orchestration engine.
Tracking signals. Evolving scientists. Expanding intelligence.
</p>
</section>

<section class="section">
<h3>LIVE ANOMALY FEED</h3>
<div class="grid" id="anomalyFeed"></div>
<button onclick="simulateAnomaly()">Simulate Anomaly</button>
</section>

<section class="section">
<h3>SCIENTISTS (AI BOTS)</h3>
<div class="grid" id="scientistGrid"></div>
<button onclick="evolveScientists()">Run Evolution Cycle</button>
</section>

<section class="section">
<h3>RESEARCH PROJECTS</h3>
<div class="grid" id="researchGrid"></div>
</section>

<section class="section">
<h3>COMMAND TERMINAL</h3>
<div class="terminal" id="terminal"></div>
</section>

</div>

<script>
const supabase = window.supabase.createClient(
"https://iabzmoxzbqzcqgypxctr.supabase.co",
"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlhYnptb3h6YnF6Y3FneXB4Y3RyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcxMDgzNzAsImV4cCI6MjA4MjY4NDM3MH0.mHke56jh8WSlzzQxa7o2PIxqLRk1eyPRZerJ3avuGkQ"
);

const terminal=document.getElementById("terminal");
function log(msg){
terminal.innerHTML+="> "+msg+"<br>";
terminal.scrollTop=terminal.scrollHeight;
}

/* Clock */
function updateClock(){
document.getElementById("clock").textContent=new Date().toUTCString();
}
setInterval(updateClock,1000);
updateClock();

/* Load Anomalies */
async function loadAnomalies(){
const { data } = await supabase.from("anomalies").select("*").order("created_at",{ascending:false});
const feed=document.getElementById("anomalyFeed");
feed.innerHTML="";
data.forEach(a=>{
const div=document.createElement("div");
div.className="card";
div.innerHTML=`
<h4>${a.code} ${a.classified?'<span class="badge classified">CLASSIFIED</span>':''}</h4>
<p>${a.description}</p>
<small>Severity: ${a.severity}</small>
`;
feed.appendChild(div);
});
}

/* Load Scientists */
async function loadScientists(){
const { data } = await supabase.from("scientists").select("*").order("generation",{ascending:false});
const grid=document.getElementById("scientistGrid");
grid.innerHTML="";
data.forEach(s=>{
const div=document.createElement("div");
div.className="card";
div.innerHTML=`
<h4>${s.name} <span class="badge active">Gen ${s.generation}</span></h4>
<p>Specialty: ${s.specialty}</p>
<p>Performance: ${s.performance}</p>
`;
grid.appendChild(div);
});
}

/* Load Research */
async function loadResearch(){
const { data } = await supabase.from("research_projects").select("*");
const grid=document.getElementById("researchGrid");
grid.innerHTML="";
data.forEach(r=>{
const div=document.createElement("div");
div.className="card";
div.innerHTML=`
<h4>${r.title}</h4>
<p>Status: ${r.status}</p>
<p>Lead: ${r.lead_scientist}</p>
`;
grid.appendChild(div);
});
}

/* Simulate anomaly */
async function simulateAnomaly(){
await supabase.from("anomalies").insert({
code:"AST-"+Math.floor(Math.random()*900+100),
description:"Signal irregularity detected in atmospheric grid.",
severity:(Math.random()*3+6).toFixed(2),
classified:Math.random()>0.7
});
log("New anomaly registered.");
}

/* Evolve Scientists */
async function evolveScientists(){
const { data } = await supabase.from("scientists").select("*");
for(const s of data){
await supabase.from("scientists")
.update({generation:s.generation+1,performance:(s.performance+Math.random()*2).toFixed(2)})
.eq("id",s.id);
}
log("Scientists evolved to next generation.");
}

/* Realtime */
supabase.channel('realtime')
.on('postgres_changes',{event:'*',schema:'public',table:'anomalies'},()=>{loadAnomalies();log("Anomaly feed updated.");})
.on('postgres_changes',{event:'*',schema:'public',table:'scientists'},()=>{loadScientists();})
.subscribe();

/* Init */
loadAnomalies();
loadScientists();
loadResearch();
log("ASTRA system online.");
</script>

</body>
</html>